# 4주차 리뷰

## 📍 HTTP
현재 모바일이나 웹 서비스에서 가장 많이 쓰이는 통신 방식이 `HTTP`통신이다. `HTTP(HyperText Transfer Protocol)`란, `텍스트 기반의 통신 규약으로 인터넷에서 데이터를 주고받을 수 있는 프로토콜이다.`

## ⚡️ HTTP의 특징
>1. 비연결지향: 클라이언트가 `request`를 서버에 보내고, 서버가 클라이언트 요청에 맞는 `response`를 보내면 바로 연결을 끊는다.
   * 이러한 단점을 해결하기위해 `cookie`와 `session`이 등장했다.
>2. 비상태정보: 연결을 끊는 순간 클라이언트와 서버의 통신은 끝나며, 상태 정보를 유지하지 않는다.
   * 연결을 유지하지 않는 프로토콜이기 때문에 `요청/방식`으로 동작한다.
>3. TCP / IP: 컴퓨터와 컴퓨터간에 데이터를 전송 할 수 있도록 하는 장치로 인터넷이라는 통신망을 통해 원하는 정보(데이터)를 주고 받는 기능을 이용 할 수 있다.

## ⚡️ HTTP의 장단점
### 장점
>1. 접속유지를 최소한으로 줄여, 더 많은 고객의 요청을 작은 리소스로 처리 할 수 있다.

### 단점
>1. 요청 간 의존관계가 없기 때문에, 현재 접속한 유저가 이전의 접속한 유저와 같은지 확인할 방법이 없다.
>2. 같은 유저인지 확인하려면 지속적으로 인증을 해줘야 한다.

---

## 📍 인증(Authentication)
인증의 정의는 `참이라는 근거가 있는 무언가를 확인하고나 확증하는 행위`다. 프론트엔드 관점으로 봤을 때 모든 API요청에 대해 사용자를 확인하는 작업이다.

만약, 사용자 A와 B가 유튜브에 로그인한다고 가정했을 때, 두 사용자가 기본적으로 갖고 있는 세팅(구독 채널리스트, 시청기록, 좋아요한 동영상, 플레이리스트 등등... )은 다를 것이다.
따라서 서버에서는 로그인했던 사용자가 누군지 정확히 알려주는 단서가 있어야 서버에서도 그 단서를 통해 각 요청에 맞는 데이터를 줄 수 있다.

---

## 📍 인증방식

### ⚡️ 계정정보를 헤더에 넣는 방식
가장 보안이 낮은 방식이다. 데이터를 요청 할 때마다 사용자의 개인정보를 보낸다. 

>장점: 인증을 테스트 할 때 빠르게 시도할 수 있다.
>단점: 보안에 매우 취약하다. 서버에서 신호가 올 때마다 `ID/PW`를 통해 인증 절차를 거쳐야한다. 

### ⚡️ `Cookie / Session` 방식
1번의 방식으로 계정 정보를 매번 헤더에 넣어서 전송하면 보안에 취약하기때문에, 이를 보완하기 위해 나온 방식이다.

#### ◉ `Cookie`란?

서버를 대신해 웹 브라우저에 저장하고 요청 할 때, 해당 정보를 서버에 보내 사용자를 식별 할 수 있게 해주는 기능이다. 사용자가 따로 요청하지 않아도 브라우저가 `Request` 할 때 `Request Header`에 넣어 자동으로 서버에 전송된다. 브라우저가 종료되어도 인증시간이 유효하다면 인증이 유지된다.

#### ◉ `Cookie` 특징

>1. 이름, 값, 만료일(저장 기간 설정), 경로 정보로 구성되어 있다.
>2. 클라이언트에 총 300개의 쿠키를 저장 할 수 있다.
>3. 하나의 도메인 당 20개의 쿠키를 가질 수 있다.
>4. 하나의 쿠키는 약 4KB(=4,096byte)까지 저장 가능하다.

#### ◉ `Cookie` 동작순서

>1. 클라이언트가 페이지를 요청한다.(사용자가 웹사이트 접근)
>2. `Server`에서 쿠키를 생성한다.
>3. 생성한 `Cookie`에 정보를 담아 `HTTP` 화면을 돌려 줄때, 클라이언트에게 같이 준다.
>4. 넘겨받은 쿠키는 클라이언트가 갖고 있다가(`Local 저장`) 다시 서버에 요청 할 때 요청과 함께 `Cookie`를 전송한다.
>5. 동일 사이트 재 방문시 클라이언트의 PC에 해당 쿠키가 있는 경우, 요청 페이지와 함께 쿠키를 전송한다.

#### ◉ `Cookie` 제어옵션
>1. `Secure`: `HTTPS` 프로토콜 상 암호화된 요청일 경우 전송
>2. `HttpOnly`: `Cross-Site` 스크립트 공격방지, `JavaScript`의 `document.cookie API` 접근 불가
>3. `Domain`: 쿠키가 전송되게 될 호스트 명시
>4. `Path`: 쿠키 `Header` 전송을 위해 요청되는 `URL` 경로
>5. `SameSite`: 쿠키가 `Cross-Site` 요청과 함께 전송되지 않음을 요구하며 위조 공격에 대한 보호방법 중 하나이다.

#### ◉ `Cookie` 사용 예시

>1. `로그인 상태유지`
>2. `자동완성`
>3. `공지메세지 하루동안 보지 않기`
>4. `비로그인 상태로 해당 상품 장바구니에 저장`

요약하자면, 사용자의 편의를 고려하며, <span style ='color:blue'>지워지거나 조작되거나 가로채이더라도 보안측에 문제가 생기지 않을 수준의 정보</span>를 브라우저에 저장한다.

---

#### ◉ `Session`이란?
세션은 쿠키를 기반으로 하지만, 사용자 정보 파일을 브라우저가 관리하는 쿠키와 달리 세션은 서버측에서 관리한다.

#### ◉ `Session` 특징
>1. `Web` 컨테이너 상태를 유지하기 위한 정보를 저장한다.
>2. 웹 서버에 저장되는 쿠키(=세션 쿠키)
>3. 사용자가 브라우저를 닫거나, 서버에서 `Session`을 삭제했을때만 삭제가 되므로, `Cookie`보다 비교적 보안이 좋다.
>4. 각 클라이언트마다 고유 `Session ID`를 부여한다.
>5. 로그인 여부, 닉네임 등 관련 정보를 `Session`에 담으면 해당 정보를 DB에서 매번 조회할 필요가 없어 효율성이 증가한다.

#### ◉ `Session` 동작순서
>1. 클라이언트가 페이지를 요청한다(사용자가 웹사이트 접근)
>2. 서버는 접근한 클라이언트의 `Request-Header`에서 `Cookie`를 확인하여, 클라이언트가 해당 `Session-id`를 보냈는지 확인한다.
>3. `Session-id`가 존재하지 않으면, 서버는 `Session-id`를 생성해 클라이언트에게 돌려준다.
>4. 서버에서 클라이언트로 돌려준 `Session-id`를 쿠키에 사용해 서버에 저장한다.
>5. 클라이언트 재접속 시, 쿠키를 이용하여 `Session-id`값을 서버에 전달한다.

#### ◉ `Session` 사용 예시
>1. 화면이 이동해도 로그인이 풀리지 않고 로그아웃하기 전까지 유지

요약하자면, 사용자나 다른 누군가에게 노출되어서는 안될 `private`한 내용처럼 서비스 제공자가 직접 관리해야하는 정보들을 서버안에서 세션으로 관리된다.

또, 세션은 서버에서 가지고 있는 정보이고 쿠키는 사용자에게 발급된 세션을 열기 위한 열쇠(Session ID)를 의미한다. 따라서 쿠키만으로 인증을 사용한다는 말은 서버의 자원은 사용하지 않는다는 것이며, 이는 즉 클라이언트의 인증 정보를 책임지게 된다. 

결과적으로 <span style='color:blue'>인증의 책임을 서버가 지게하기위해 세션을 사용한다.</span> 사용자는 쿠키를 이용하고, 서버에서는 쿠키를 받아 세션의 정보를 접근하는 방식으로 인증을 한다.

---

#### 💡 `Cookie`와 `Session`의 차이점

|  | 쿠키(Cookie) | 세션(Session) |
| :----: | :------: | :------:|
| 저장 위치 | 클라이언트(접속자 PC) | 서버 |
| 저장 형식 | text | Object |
| 만료 시점 | 쿠키 저장시 설정(브라우저가 종료되도, 자동 삭제되지 않음) | 브라우저 종료시 삭제(기간 지정 가능) |
| 용량제한 | 하나의 쿠키 당 4KB | 서버 용량따라 |
| 속도 | 세션보다 빠름 | 쿠키보다 느림 |
| 보안 | 세션보다 취약함 | 쿠키보다 좋음 |

---

### ⚡️ 토큰 기반 인증방식(JWT)

#### ◉ `JWT` 란?
JWT는 `Json Web Token`의 약자로서 인증에 필요한 정보들을 암호화시킨 토큰을 뜻한다. `Session/Cookie` 방식과 유사하게 사용자는 `Access Token(JWT 토큰)`을 `HTTP` 헤더에 실어 서버로 보내게 된다.

#### ◉ `JWT` 특징
>1. Self-contained(자가 수용적): JWT 자체적으로 필요한 모든 정보를 포함한다. 
   * 헤더정보(Header), 실제 전달할 데이터(Payload), 검증할 수 있는 서명 데이터(Verify Signature)
>2. Reliability(신뢰성): 디지털 서명에 의해 검증 할 수 있으며, 신뢰 할 수 있다.

#### ◉ `JWT` 장점
>1. 사용자에 대한 정보가 `Token` 안에 들어가 있기 때문에 다른 곳에서 가져올 필요가 없다.
>2. `JSON parser`는 대부분의 프로그래밍이 지원하기 때문에 만들기 쉽다.
>3. `Session`을 사용하지 않아도 되므로, 서버 비용을 줄일 수 있다.

#### ◉ `JWT` 단점
>1. 세션/쿠키의 경우 해당 세션을 지우면 되지만, JWT에서는 이미 발급된 `Token`을 수정할 수 없다.
>  * 기존 `Access Token`의 유효기간을 짧게 하고 `Refresh Token`을 발급한다. 
>2. 더 많은 필드가 추가되면 `Token`이 커질 수 있다.
>3. 비상태 `Application`에서 `Token`은 모든 요청에 전송되므로 데이터 트래픽 크기에 영향을 끼칠 수 있다.

#### ◉ `JWT` 동작순서
>1. 사용자가 로그인을 한다.
>2. 서버에서 계정정보를 읽어 사용자를 확인 한 후 사용자의 고유 ID값을 부여하고 나머지 기타정보를 `payload`에 넣는다.
>3. `JWT` 토큰의 유효기간을 설정한다.
>4. `Secret_key`를 이용해 `Access_Token`을 발급한다.
>5. 사용자는 `Access_Token`을 받아 저장한 후, 인증이 필요한 요청마다 토큰을 헤더에 실어 보낸다.
>6. 서버에서 해당 토큰의 `Verify Signature`을 `Secret_key`로 복호화한 후, 조작여부, 유효기간을 확인한다.
>7. 검증이 완료되면, `Payload`를 디코딩하여 사용자 Id에 맞는 데이터를 가져온다.

#### ◉ `JWT`와 `Session / Cookie`와의 차이점
>1. `Session / Cookie`는 세션 저장소에 유저의 정보를 넣는 반면, `JWT`는 토큰 안에 유저의 정보들을 넣는다.
   * 클라이언트 입장에서는 `HTTP header`에 `세션ID`나 `토큰`을 넣는다는점에서 동일하나, 서버 측에서 인증을 위해 암호화를 하는지, 별도의 저장소를 이용하는지에 차이가 발생한다.

---

## 💡 [ 번외 ] `Cache`란?
자주 사용하는 데이터나 값을 `memory`에 미리 복사해 놓는 임시 장소를 뜻한다. 캐시는 저장 공간이 작고 비용이 비싼 대신 빠른 성능을 제공한다.

사용자가 웹 사이트에 접속할 때, 정적 컨텐츠(image, JS, CSS...)를 특정 위치 (client, network 등) 에 저장하여, 웹 사이트 서버에 해당 컨텐츠를 매번 요청하여 받는것이 아니라, 특정 위치에서 불러옴으로써 사이트 응답시간을 줄이고, 서버 트래픽 감소 효과를 볼 수 있다.

### 💡 `Cache`사용 예시
>1. 접근시간에 비해 원래 데이터를 접근하는 시간이 오래 걸리는 경우(서버의 균일한 `API` 데이터)
>2. 반복적으로 동일한 결과를 돌려주는 경우(Img, thumbnail...)

>  가져오는데 비용이 드는 데이터를 한 번 가져온뒤에 임시로 저장해둔다. 웹 캐시는 이미지 등의 정보를 불러올때 데이터 사용량도 발생하고 시간도 들기때문에 사용자가 여러번 방문할 법한 사이트에서는 한 번 받아온 데이터를 사용자의 컴퓨터 또는 중간 역할을 하는 서버에 저장해둔다.

---

출처.

https://velog.io/@surim014/HTTP%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80

https://toycrane.medium.com/%EC%BF%A0%ED%82%A4%EC%99%80-%EC%84%B8%EC%85%98-fd1c93716fc7

https://tansfil.tistory.com/58?category=255594

---

# 튜터에게 궁금한 점
1. `Session`을 관리 할 때 `redis`를 쓰는 이유는 무엇인가요? 또, `mysql`보다 빠른 이유는 무엇인가요?
2. 쇼핑몰 프로젝트를 진행하는데 `상품들 JSON data`를 받을 수 있는 사이트가 있을까요?
